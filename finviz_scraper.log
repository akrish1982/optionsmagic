2025-04-04 09:00:03,439 - __main__ - INFO - Table stock_quotes created or already exists
2025-04-04 09:00:03,441 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-04 09:00:03,441 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-04 09:00:04,977 - __main__ - INFO - Successfully fetched page, length: 170658
2025-04-04 09:00:05,116 - __main__ - INFO - Found 23 tables in the document
2025-04-04 09:00:05,116 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 09:00:05,117 - __main__ - INFO - Found 20 data rows
2025-04-04 09:00:05,122 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 09:00:05,122 - __main__ - INFO - Extracted data for 20 stocks
2025-04-04 09:00:05,184 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-04 09:00:05,191 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-04-04 09:00:05,191 - __main__ - INFO - Waiting 2.27 seconds before next page...
2025-04-04 09:00:07,539 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 09:00:07,539 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 09:00:10,033 - __main__ - INFO - Successfully fetched page, length: 170765
2025-04-04 09:00:10,132 - __main__ - INFO - Found 23 tables in the document
2025-04-04 09:00:10,132 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 09:00:10,133 - __main__ - INFO - Found 20 data rows
2025-04-04 09:00:10,138 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 09:00:10,138 - __main__ - INFO - Extracted data for 20 stocks
2025-04-04 09:00:10,193 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-04 09:00:10,193 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-04-04 09:00:10,194 - __main__ - INFO - Waiting 3.05 seconds before next page...
2025-04-04 09:00:13,253 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 09:00:13,253 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 09:00:15,057 - __main__ - INFO - Successfully fetched page, length: 143312
2025-04-04 09:00:15,132 - __main__ - INFO - Found 23 tables in the document
2025-04-04 09:00:15,132 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 09:00:15,133 - __main__ - INFO - Found 9 data rows
2025-04-04 09:00:15,136 - __main__ - INFO - No 'next' link found.
2025-04-04 09:00:15,136 - __main__ - INFO - Extracted data for 9 stocks
2025-04-04 09:00:15,405 - __main__ - INFO - Successfully upserted data for 9 stocks
2025-04-04 09:00:15,406 - __main__ - INFO - Added 9 stocks from page 3 (total: 49)
2025-04-04 09:00:15,406 - __main__ - INFO - Scraping completed. Total stocks: 49
2025-04-04 09:00:15,406 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 49
2025-04-04 09:47:12,263 - __main__ - INFO - Table stock_quotes created or already exists
2025-04-04 09:47:12,264 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-04 09:47:12,264 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-04 09:47:14,366 - __main__ - INFO - Successfully fetched page, length: 170682
2025-04-04 09:47:14,435 - __main__ - INFO - Found 23 tables in the document
2025-04-04 09:47:14,435 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 09:47:14,436 - __main__ - INFO - Found 20 data rows
2025-04-04 09:47:14,438 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 09:47:14,438 - __main__ - INFO - Extracted data for 20 stocks
2025-04-04 09:47:14,499 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-04 09:47:14,499 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-04-04 09:47:14,499 - __main__ - INFO - Waiting 2.95 seconds before next page...
2025-04-04 09:47:17,449 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 09:47:17,450 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 09:47:18,819 - __main__ - INFO - Successfully fetched page, length: 170653
2025-04-04 09:47:18,883 - __main__ - INFO - Found 23 tables in the document
2025-04-04 09:47:18,883 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 09:47:18,884 - __main__ - INFO - Found 20 data rows
2025-04-04 09:47:18,886 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 09:47:18,886 - __main__ - INFO - Extracted data for 20 stocks
2025-04-04 09:47:18,934 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-04 09:47:18,934 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-04-04 09:47:18,934 - __main__ - INFO - Waiting 3.37 seconds before next page...
2025-04-04 09:47:22,312 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 09:47:22,313 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 09:47:24,262 - __main__ - INFO - Successfully fetched page, length: 138339
2025-04-04 09:47:24,299 - __main__ - INFO - Found 23 tables in the document
2025-04-04 09:47:24,299 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 09:47:24,300 - __main__ - INFO - Found 7 data rows
2025-04-04 09:47:24,301 - __main__ - INFO - No 'next' link found.
2025-04-04 09:47:24,301 - __main__ - INFO - Extracted data for 7 stocks
2025-04-04 09:47:24,352 - __main__ - INFO - Successfully upserted data for 7 stocks
2025-04-04 09:47:24,353 - __main__ - INFO - Added 7 stocks from page 3 (total: 47)
2025-04-04 09:47:24,353 - __main__ - INFO - Scraping completed. Total stocks: 47
2025-04-04 09:47:24,353 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 47
2025-04-04 10:00:05,161 - __main__ - INFO - Table stock_quotes created or already exists
2025-04-04 10:00:05,164 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-04 10:00:05,164 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-04 10:00:09,518 - __main__ - INFO - Successfully fetched page, length: 170699
2025-04-04 10:00:09,638 - __main__ - INFO - Found 23 tables in the document
2025-04-04 10:00:09,639 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 10:00:09,639 - __main__ - INFO - Found 20 data rows
2025-04-04 10:00:09,644 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 10:00:09,644 - __main__ - INFO - Extracted data for 20 stocks
2025-04-04 10:00:11,722 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-04 10:00:11,722 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-04-04 10:00:11,722 - __main__ - INFO - Waiting 2.31 seconds before next page...
2025-04-04 10:00:14,166 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 10:00:14,166 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 10:00:17,603 - __main__ - INFO - Successfully fetched page, length: 170671
2025-04-04 10:00:17,686 - __main__ - INFO - Found 23 tables in the document
2025-04-04 10:00:17,687 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 10:00:17,687 - __main__ - INFO - Found 20 data rows
2025-04-04 10:00:17,692 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 10:00:17,692 - __main__ - INFO - Extracted data for 20 stocks
2025-04-04 10:00:19,826 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-04 10:00:19,827 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-04-04 10:00:19,827 - __main__ - INFO - Waiting 3.37 seconds before next page...
2025-04-04 10:00:23,317 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 10:00:23,318 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 10:00:24,856 - __main__ - INFO - Successfully fetched page, length: 138342
2025-04-04 10:00:25,071 - __main__ - INFO - Found 23 tables in the document
2025-04-04 10:00:25,071 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 10:00:25,071 - __main__ - INFO - Found 7 data rows
2025-04-04 10:00:25,075 - __main__ - INFO - No 'next' link found.
2025-04-04 10:00:25,075 - __main__ - INFO - Extracted data for 7 stocks
2025-04-04 10:00:27,189 - __main__ - INFO - Successfully upserted data for 7 stocks
2025-04-04 10:00:27,189 - __main__ - INFO - Added 7 stocks from page 3 (total: 47)
2025-04-04 10:00:27,190 - __main__ - INFO - Scraping completed. Total stocks: 47
2025-04-04 10:00:27,190 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 47
2025-04-04 11:00:46,699 - __main__ - INFO - Table stock_quotes created or already exists
2025-04-04 11:00:46,701 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-04 11:00:46,702 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-04 11:00:48,196 - __main__ - INFO - Successfully fetched page, length: 170730
2025-04-04 11:00:48,315 - __main__ - INFO - Found 23 tables in the document
2025-04-04 11:00:48,316 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 11:00:48,317 - __main__ - INFO - Found 20 data rows
2025-04-04 11:00:48,322 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 11:00:48,322 - __main__ - INFO - Extracted data for 20 stocks
2025-04-04 11:00:48,402 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-04 11:00:48,402 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-04-04 11:00:48,402 - __main__ - INFO - Waiting 2.82 seconds before next page...
2025-04-04 11:00:51,264 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 11:00:51,265 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 11:00:53,265 - __main__ - INFO - Successfully fetched page, length: 170706
2025-04-04 11:00:53,357 - __main__ - INFO - Found 23 tables in the document
2025-04-04 11:00:53,358 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 11:00:53,358 - __main__ - INFO - Found 20 data rows
2025-04-04 11:00:53,362 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 11:00:53,363 - __main__ - INFO - Extracted data for 20 stocks
2025-04-04 11:00:53,445 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-04 11:00:53,446 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-04-04 11:00:53,446 - __main__ - INFO - Waiting 3.49 seconds before next page...
2025-04-04 11:00:56,953 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 11:00:56,954 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 11:00:59,480 - __main__ - INFO - Successfully fetched page, length: 135880
2025-04-04 11:00:59,548 - __main__ - INFO - Found 23 tables in the document
2025-04-04 11:00:59,549 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 11:00:59,549 - __main__ - INFO - Found 6 data rows
2025-04-04 11:00:59,551 - __main__ - INFO - No 'next' link found.
2025-04-04 11:00:59,551 - __main__ - INFO - Extracted data for 6 stocks
2025-04-04 11:00:59,629 - __main__ - INFO - Successfully upserted data for 6 stocks
2025-04-04 11:00:59,629 - __main__ - INFO - Added 6 stocks from page 3 (total: 46)
2025-04-04 11:00:59,629 - __main__ - INFO - Scraping completed. Total stocks: 46
2025-04-04 11:00:59,630 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 46
2025-04-04 12:00:04,043 - __main__ - INFO - Table stock_quotes created or already exists
2025-04-04 12:00:04,044 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-04 12:00:04,044 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-04 12:00:06,123 - __main__ - INFO - Successfully fetched page, length: 170734
2025-04-04 12:00:06,238 - __main__ - INFO - Found 23 tables in the document
2025-04-04 12:00:06,239 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 12:00:06,240 - __main__ - INFO - Found 20 data rows
2025-04-04 12:00:06,244 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 12:00:06,244 - __main__ - INFO - Extracted data for 20 stocks
2025-04-04 12:00:06,310 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-04 12:00:06,311 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-04-04 12:00:06,311 - __main__ - INFO - Waiting 3.63 seconds before next page...
2025-04-04 12:00:09,977 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 12:00:09,977 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 12:00:12,041 - __main__ - INFO - Successfully fetched page, length: 170823
2025-04-04 12:00:12,127 - __main__ - INFO - Found 23 tables in the document
2025-04-04 12:00:12,128 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 12:00:12,129 - __main__ - INFO - Found 20 data rows
2025-04-04 12:00:12,133 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 12:00:12,134 - __main__ - INFO - Extracted data for 20 stocks
2025-04-04 12:00:12,237 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-04 12:00:12,238 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-04-04 12:00:12,238 - __main__ - INFO - Waiting 2.35 seconds before next page...
2025-04-04 12:00:14,674 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 12:00:14,675 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 12:00:16,066 - __main__ - INFO - Successfully fetched page, length: 133389
2025-04-04 12:00:16,137 - __main__ - INFO - Found 23 tables in the document
2025-04-04 12:00:16,138 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 12:00:16,138 - __main__ - INFO - Found 5 data rows
2025-04-04 12:00:16,141 - __main__ - INFO - No 'next' link found.
2025-04-04 12:00:16,141 - __main__ - INFO - Extracted data for 5 stocks
2025-04-04 12:00:16,205 - __main__ - INFO - Successfully upserted data for 5 stocks
2025-04-04 12:00:16,206 - __main__ - INFO - Added 5 stocks from page 3 (total: 45)
2025-04-04 12:00:16,206 - __main__ - INFO - Scraping completed. Total stocks: 45
2025-04-04 12:00:16,206 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 45
2025-04-04 13:00:04,102 - __main__ - INFO - Table stock_quotes created or already exists
2025-04-04 13:00:04,103 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-04 13:00:04,103 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-04 13:00:05,928 - __main__ - INFO - Successfully fetched page, length: 170733
2025-04-04 13:00:06,052 - __main__ - INFO - Found 23 tables in the document
2025-04-04 13:00:06,053 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 13:00:06,053 - __main__ - INFO - Found 20 data rows
2025-04-04 13:00:06,058 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 13:00:06,058 - __main__ - INFO - Extracted data for 20 stocks
2025-04-04 13:00:06,141 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-04 13:00:06,141 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-04-04 13:00:06,141 - __main__ - INFO - Waiting 3.00 seconds before next page...
2025-04-04 13:00:09,220 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 13:00:09,220 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 13:00:11,259 - __main__ - INFO - Successfully fetched page, length: 170819
2025-04-04 13:00:11,346 - __main__ - INFO - Found 23 tables in the document
2025-04-04 13:00:11,347 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 13:00:11,347 - __main__ - INFO - Found 20 data rows
2025-04-04 13:00:11,352 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 13:00:11,352 - __main__ - INFO - Extracted data for 20 stocks
2025-04-04 13:00:11,435 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-04 13:00:11,435 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-04-04 13:00:11,435 - __main__ - INFO - Waiting 2.24 seconds before next page...
2025-04-04 13:00:13,754 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 13:00:13,754 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 13:00:15,511 - __main__ - INFO - Successfully fetched page, length: 133389
2025-04-04 13:00:15,582 - __main__ - INFO - Found 23 tables in the document
2025-04-04 13:00:15,583 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 13:00:15,583 - __main__ - INFO - Found 5 data rows
2025-04-04 13:00:15,586 - __main__ - INFO - No 'next' link found.
2025-04-04 13:00:15,586 - __main__ - INFO - Extracted data for 5 stocks
2025-04-04 13:00:15,671 - __main__ - INFO - Successfully upserted data for 5 stocks
2025-04-04 13:00:15,671 - __main__ - INFO - Added 5 stocks from page 3 (total: 45)
2025-04-04 13:00:15,671 - __main__ - INFO - Scraping completed. Total stocks: 45
2025-04-04 13:00:15,672 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 45
2025-04-04 16:00:03,972 - __main__ - INFO - Table stock_quotes created or already exists
2025-04-04 16:00:03,974 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-04 16:00:03,974 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-04 16:00:05,625 - __main__ - INFO - Successfully fetched page, length: 170796
2025-04-04 16:00:05,753 - __main__ - INFO - Found 23 tables in the document
2025-04-04 16:00:05,753 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 16:00:05,754 - __main__ - INFO - Found 20 data rows
2025-04-04 16:00:05,758 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 16:00:05,758 - __main__ - INFO - Extracted data for 20 stocks
2025-04-04 16:00:05,863 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-04 16:00:05,864 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-04-04 16:00:05,864 - __main__ - INFO - Waiting 3.94 seconds before next page...
2025-04-04 16:00:09,951 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 16:00:09,952 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 16:00:12,130 - __main__ - INFO - Successfully fetched page, length: 170833
2025-04-04 16:00:12,221 - __main__ - INFO - Found 23 tables in the document
2025-04-04 16:00:12,221 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 16:00:12,222 - __main__ - INFO - Found 20 data rows
2025-04-04 16:00:12,226 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 16:00:12,227 - __main__ - INFO - Extracted data for 20 stocks
2025-04-04 16:00:12,334 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-04 16:00:12,335 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-04-04 16:00:12,335 - __main__ - INFO - Waiting 2.32 seconds before next page...
2025-04-04 16:00:14,742 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 16:00:14,742 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 16:00:16,971 - __main__ - INFO - Successfully fetched page, length: 135869
2025-04-04 16:00:17,044 - __main__ - INFO - Found 23 tables in the document
2025-04-04 16:00:17,044 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 16:00:17,045 - __main__ - INFO - Found 6 data rows
2025-04-04 16:00:17,047 - __main__ - INFO - No 'next' link found.
2025-04-04 16:00:17,047 - __main__ - INFO - Extracted data for 6 stocks
2025-04-04 16:00:17,175 - __main__ - INFO - Successfully upserted data for 6 stocks
2025-04-04 16:00:17,176 - __main__ - INFO - Added 6 stocks from page 3 (total: 46)
2025-04-04 16:00:17,176 - __main__ - INFO - Scraping completed. Total stocks: 46
2025-04-04 16:00:17,177 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 46
2025-04-04 22:00:03,272 - __main__ - INFO - Table stock_quotes created or already exists
2025-04-04 22:00:03,273 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-04 22:00:03,273 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-04 22:00:06,606 - __main__ - INFO - Successfully fetched page, length: 170794
2025-04-04 22:00:06,730 - __main__ - INFO - Found 23 tables in the document
2025-04-04 22:00:06,731 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 22:00:06,731 - __main__ - INFO - Found 20 data rows
2025-04-04 22:00:06,736 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 22:00:06,737 - __main__ - INFO - Extracted data for 20 stocks
2025-04-04 22:00:06,836 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-04 22:00:06,836 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-04-04 22:00:06,836 - __main__ - INFO - Waiting 3.95 seconds before next page...
2025-04-04 22:00:10,814 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 22:00:10,814 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 22:00:12,314 - __main__ - INFO - Successfully fetched page, length: 170841
2025-04-04 22:00:12,403 - __main__ - INFO - Found 23 tables in the document
2025-04-04 22:00:12,403 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 22:00:12,404 - __main__ - INFO - Found 20 data rows
2025-04-04 22:00:12,409 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 22:00:12,410 - __main__ - INFO - Extracted data for 20 stocks
2025-04-04 22:00:12,513 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-04 22:00:12,514 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-04-04 22:00:12,514 - __main__ - INFO - Waiting 2.90 seconds before next page...
2025-04-04 22:00:15,485 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 22:00:15,487 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 22:00:18,587 - __main__ - INFO - Successfully fetched page, length: 133401
2025-04-04 22:00:18,659 - __main__ - INFO - Found 23 tables in the document
2025-04-04 22:00:18,660 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 22:00:18,660 - __main__ - INFO - Found 5 data rows
2025-04-04 22:00:18,663 - __main__ - INFO - No 'next' link found.
2025-04-04 22:00:18,663 - __main__ - INFO - Extracted data for 5 stocks
2025-04-04 22:00:18,745 - __main__ - INFO - Successfully upserted data for 5 stocks
2025-04-04 22:00:18,745 - __main__ - INFO - Added 5 stocks from page 3 (total: 45)
2025-04-04 22:00:18,745 - __main__ - INFO - Scraping completed. Total stocks: 45
2025-04-04 22:00:18,746 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 45
2025-04-04 23:00:03,644 - __main__ - INFO - Table stock_quotes created or already exists
2025-04-04 23:00:03,646 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-04 23:00:03,646 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-04 23:00:06,806 - __main__ - INFO - Successfully fetched page, length: 170794
2025-04-04 23:00:06,930 - __main__ - INFO - Found 23 tables in the document
2025-04-04 23:00:06,931 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 23:00:06,932 - __main__ - INFO - Found 20 data rows
2025-04-04 23:00:06,936 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 23:00:06,936 - __main__ - INFO - Extracted data for 20 stocks
2025-04-04 23:00:07,052 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-04 23:00:07,052 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-04-04 23:00:07,052 - __main__ - INFO - Waiting 3.67 seconds before next page...
2025-04-04 23:00:10,799 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 23:00:10,799 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-04 23:00:13,940 - __main__ - INFO - Successfully fetched page, length: 170831
2025-04-04 23:00:14,035 - __main__ - INFO - Found 23 tables in the document
2025-04-04 23:00:14,035 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 23:00:14,036 - __main__ - INFO - Found 20 data rows
2025-04-04 23:00:14,040 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 23:00:14,040 - __main__ - INFO - Extracted data for 20 stocks
2025-04-04 23:00:14,149 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-04 23:00:14,149 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-04-04 23:00:14,149 - __main__ - INFO - Waiting 3.25 seconds before next page...
2025-04-04 23:00:17,466 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 23:00:17,466 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-04 23:00:19,243 - __main__ - INFO - Successfully fetched page, length: 133402
2025-04-04 23:00:19,316 - __main__ - INFO - Found 23 tables in the document
2025-04-04 23:00:19,316 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-04 23:00:19,317 - __main__ - INFO - Found 5 data rows
2025-04-04 23:00:19,319 - __main__ - INFO - No 'next' link found.
2025-04-04 23:00:19,319 - __main__ - INFO - Extracted data for 5 stocks
2025-04-04 23:00:19,437 - __main__ - INFO - Successfully upserted data for 5 stocks
2025-04-04 23:00:19,438 - __main__ - INFO - Added 5 stocks from page 3 (total: 45)
2025-04-04 23:00:19,438 - __main__ - INFO - Scraping completed. Total stocks: 45
2025-04-04 23:00:19,438 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 45
2025-04-10 14:30:49,344 - __main__ - INFO - Table stock_quotes created or already exists
2025-04-10 14:30:49,346 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-10 14:30:49,346 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-04-10 14:30:51,365 - __main__ - INFO - Successfully fetched page, length: 170742
2025-04-10 14:30:51,443 - __main__ - INFO - Found 23 tables in the document
2025-04-10 14:30:51,444 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-10 14:30:51,444 - __main__ - INFO - Found 20 data rows
2025-04-10 14:30:51,446 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-10 14:30:51,446 - __main__ - INFO - Extracted data for 20 stocks
2025-04-10 14:30:51,566 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-10 14:30:51,566 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-04-10 14:30:51,566 - __main__ - INFO - Waiting 3.94 seconds before next page...
2025-04-10 14:30:55,509 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-10 14:30:55,509 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-04-10 14:30:57,747 - __main__ - INFO - Successfully fetched page, length: 170838
2025-04-10 14:30:57,799 - __main__ - INFO - Found 23 tables in the document
2025-04-10 14:30:57,800 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-10 14:30:57,800 - __main__ - INFO - Found 20 data rows
2025-04-10 14:30:57,802 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-10 14:30:57,802 - __main__ - INFO - Extracted data for 20 stocks
2025-04-10 14:30:57,906 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-10 14:30:57,906 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-04-10 14:30:57,906 - __main__ - INFO - Waiting 2.32 seconds before next page...
2025-04-10 14:31:00,228 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-10 14:31:00,228 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-04-10 14:31:02,555 - __main__ - INFO - Successfully fetched page, length: 130886
2025-04-10 14:31:02,600 - __main__ - INFO - Found 23 tables in the document
2025-04-10 14:31:02,600 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-10 14:31:02,601 - __main__ - INFO - Found 4 data rows
2025-04-10 14:31:02,602 - __main__ - INFO - No 'next' link found.
2025-04-10 14:31:02,602 - __main__ - INFO - Extracted data for 4 stocks
2025-04-10 14:31:02,699 - __main__ - INFO - Successfully upserted data for 4 stocks
2025-04-10 14:31:02,699 - __main__ - INFO - Added 4 stocks from page 3 (total: 44)
2025-04-10 14:31:02,699 - __main__ - INFO - Scraping completed. Total stocks: 44
2025-04-10 14:31:02,700 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 44
2025-04-11 15:13:32,007 - __main__ - INFO - Table stock_quotes created or already exists
2025-04-11 15:13:32,009 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=1
2025-04-11 15:13:32,009 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=1
2025-04-11 15:13:34,970 - __main__ - INFO - Successfully fetched page, length: 174207
2025-04-11 15:13:35,037 - __main__ - INFO - Found 23 tables in the document
2025-04-11 15:13:35,037 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-11 15:13:35,037 - __main__ - INFO - Found 20 data rows
2025-04-11 15:13:35,039 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=21
2025-04-11 15:13:35,039 - __main__ - INFO - Extracted data for 20 stocks
2025-04-11 15:13:35,154 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-11 15:13:35,154 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-04-11 15:13:35,154 - __main__ - INFO - Waiting 2.10 seconds before next page...
2025-04-11 15:13:37,259 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=21
2025-04-11 15:13:37,260 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=21
2025-04-11 15:13:39,039 - __main__ - INFO - Successfully fetched page, length: 174752
2025-04-11 15:13:39,096 - __main__ - INFO - Found 23 tables in the document
2025-04-11 15:13:39,096 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-11 15:13:39,096 - __main__ - INFO - Found 20 data rows
2025-04-11 15:13:39,098 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=41
2025-04-11 15:13:39,098 - __main__ - INFO - Extracted data for 20 stocks
2025-04-11 15:13:39,207 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-11 15:13:39,207 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-04-11 15:13:39,208 - __main__ - INFO - Waiting 2.42 seconds before next page...
2025-04-11 15:13:41,625 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=41
2025-04-11 15:13:41,626 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=41
2025-04-11 15:13:43,458 - __main__ - INFO - Successfully fetched page, length: 174689
2025-04-11 15:13:43,514 - __main__ - INFO - Found 23 tables in the document
2025-04-11 15:13:43,514 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-11 15:13:43,515 - __main__ - INFO - Found 20 data rows
2025-04-11 15:13:43,517 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=61
2025-04-11 15:13:43,517 - __main__ - INFO - Extracted data for 20 stocks
2025-04-11 15:13:43,629 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-11 15:13:43,629 - __main__ - INFO - Added 20 stocks from page 3 (total: 60)
2025-04-11 15:13:43,629 - __main__ - INFO - Waiting 3.10 seconds before next page...
2025-04-11 15:13:46,730 - __main__ - INFO - Scraping page 4: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=61
2025-04-11 15:13:46,731 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=61
2025-04-11 15:13:48,421 - __main__ - INFO - Successfully fetched page, length: 175036
2025-04-11 15:13:48,476 - __main__ - INFO - Found 23 tables in the document
2025-04-11 15:13:48,476 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-11 15:13:48,476 - __main__ - INFO - Found 20 data rows
2025-04-11 15:13:48,478 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=81
2025-04-11 15:13:48,478 - __main__ - INFO - Extracted data for 20 stocks
2025-04-11 15:13:48,573 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-11 15:13:48,573 - __main__ - INFO - Added 20 stocks from page 4 (total: 80)
2025-04-11 15:13:48,573 - __main__ - INFO - Waiting 2.08 seconds before next page...
2025-04-11 15:13:50,659 - __main__ - INFO - Scraping page 5: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=81
2025-04-11 15:13:50,660 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=81
2025-04-11 15:13:53,298 - __main__ - INFO - Successfully fetched page, length: 175365
2025-04-11 15:13:53,354 - __main__ - INFO - Found 23 tables in the document
2025-04-11 15:13:53,354 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-11 15:13:53,355 - __main__ - INFO - Found 20 data rows
2025-04-11 15:13:53,357 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=101
2025-04-11 15:13:53,357 - __main__ - INFO - Extracted data for 20 stocks
2025-04-11 15:13:53,456 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-11 15:13:53,457 - __main__ - INFO - Added 20 stocks from page 5 (total: 100)
2025-04-11 15:13:53,457 - __main__ - INFO - Waiting 2.97 seconds before next page...
2025-04-11 15:13:56,429 - __main__ - INFO - Scraping page 6: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=101
2025-04-11 15:13:56,429 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=101
2025-04-11 15:13:58,495 - __main__ - INFO - Successfully fetched page, length: 175102
2025-04-11 15:13:58,574 - __main__ - INFO - Found 23 tables in the document
2025-04-11 15:13:58,574 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-11 15:13:58,575 - __main__ - INFO - Found 20 data rows
2025-04-11 15:13:58,577 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=121
2025-04-11 15:13:58,577 - __main__ - INFO - Extracted data for 20 stocks
2025-04-11 15:13:58,668 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-11 15:13:58,668 - __main__ - INFO - Added 20 stocks from page 6 (total: 120)
2025-04-11 15:13:58,668 - __main__ - INFO - Waiting 2.63 seconds before next page...
2025-04-11 15:14:01,308 - __main__ - INFO - Scraping page 7: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=121
2025-04-11 15:14:01,310 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=121
2025-04-11 15:14:03,192 - __main__ - INFO - Successfully fetched page, length: 175493
2025-04-11 15:14:03,245 - __main__ - INFO - Found 23 tables in the document
2025-04-11 15:14:03,246 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-11 15:14:03,246 - __main__ - INFO - Found 20 data rows
2025-04-11 15:14:03,248 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=141
2025-04-11 15:14:03,248 - __main__ - INFO - Extracted data for 20 stocks
2025-04-11 15:14:03,368 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-11 15:14:03,368 - __main__ - INFO - Added 20 stocks from page 7 (total: 140)
2025-04-11 15:14:03,368 - __main__ - INFO - Waiting 4.00 seconds before next page...
2025-04-11 15:14:07,366 - __main__ - INFO - Scraping page 8: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=141
2025-04-11 15:14:07,367 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=141
2025-04-11 15:14:09,949 - __main__ - INFO - Successfully fetched page, length: 175490
2025-04-11 15:14:10,003 - __main__ - INFO - Found 23 tables in the document
2025-04-11 15:14:10,003 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-11 15:14:10,004 - __main__ - INFO - Found 20 data rows
2025-04-11 15:14:10,006 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=161
2025-04-11 15:14:10,006 - __main__ - INFO - Extracted data for 20 stocks
2025-04-11 15:14:10,123 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-11 15:14:10,124 - __main__ - INFO - Added 20 stocks from page 8 (total: 160)
2025-04-11 15:14:10,124 - __main__ - INFO - Waiting 2.13 seconds before next page...
2025-04-11 15:14:12,254 - __main__ - INFO - Scraping page 9: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=161
2025-04-11 15:14:12,255 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=161
2025-04-11 15:14:14,808 - __main__ - INFO - Successfully fetched page, length: 175218
2025-04-11 15:14:14,864 - __main__ - INFO - Found 23 tables in the document
2025-04-11 15:14:14,864 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-11 15:14:14,865 - __main__ - INFO - Found 20 data rows
2025-04-11 15:14:14,867 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=181
2025-04-11 15:14:14,867 - __main__ - INFO - Extracted data for 20 stocks
2025-04-11 15:14:14,969 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-11 15:14:14,969 - __main__ - INFO - Added 20 stocks from page 9 (total: 180)
2025-04-11 15:14:14,969 - __main__ - INFO - Waiting 3.70 seconds before next page...
2025-04-11 15:14:18,674 - __main__ - INFO - Scraping page 10: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=181
2025-04-11 15:14:18,675 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=181
2025-04-11 15:14:21,391 - __main__ - INFO - Successfully fetched page, length: 175246
2025-04-11 15:14:21,445 - __main__ - INFO - Found 23 tables in the document
2025-04-11 15:14:21,445 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-11 15:14:21,446 - __main__ - INFO - Found 20 data rows
2025-04-11 15:14:21,448 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=201
2025-04-11 15:14:21,448 - __main__ - INFO - Extracted data for 20 stocks
2025-04-11 15:14:21,544 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-11 15:14:21,544 - __main__ - INFO - Added 20 stocks from page 10 (total: 200)
2025-04-11 15:14:21,544 - __main__ - INFO - Waiting 3.22 seconds before next page...
2025-04-11 15:14:24,769 - __main__ - INFO - Scraping completed. Total stocks: 200
2025-04-11 15:14:24,771 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 200
2025-04-19 14:08:26,803 - __main__ - ERROR - Database connection error: connection to server at "aws-0-us-east-1.pooler.supabase.com" (44.208.221.186), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-us-east-1.pooler.supabase.com" (44.208.221.186), port 6543 failed: FATAL:  Tenant or user not found

2025-04-19 14:08:26,803 - __main__ - ERROR - Error in scrape_finviz_stocks_with_options: connection to server at "aws-0-us-east-1.pooler.supabase.com" (44.208.221.186), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-us-east-1.pooler.supabase.com" (44.208.221.186), port 6543 failed: FATAL:  Tenant or user not found

2025-04-19 14:08:26,804 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 0
2025-04-19 14:09:49,020 - __main__ - ERROR - Database connection error: connection to server at "aws-0-us-east-1.pooler.supabase.com" (52.45.94.125), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-us-east-1.pooler.supabase.com" (52.45.94.125), port 6543 failed: FATAL:  Tenant or user not found

2025-04-19 14:09:49,021 - __main__ - ERROR - Error in scrape_finviz_stocks_with_options: connection to server at "aws-0-us-east-1.pooler.supabase.com" (52.45.94.125), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-us-east-1.pooler.supabase.com" (52.45.94.125), port 6543 failed: FATAL:  Tenant or user not found

2025-04-19 14:09:49,021 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 0
2025-04-19 14:11:20,748 - __main__ - ERROR - Database connection error: connection to server at "aws-0-us-east-1.pooler.supabase.com" (44.216.29.125), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-us-east-1.pooler.supabase.com" (44.216.29.125), port 6543 failed: FATAL:  Tenant or user not found

2025-04-19 14:11:20,749 - __main__ - ERROR - Error in scrape_finviz_stocks_with_options: connection to server at "aws-0-us-east-1.pooler.supabase.com" (44.216.29.125), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-us-east-1.pooler.supabase.com" (44.216.29.125), port 6543 failed: FATAL:  Tenant or user not found

<<<<<<< HEAD
2025-03-16 18:15:44,463 - __main__ - INFO - Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option
2025-03-16 18:15:44,463 - __main__ - INFO - Extracted data for 20 stocks
2025-03-16 18:15:44,467 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-03-16 18:15:44,467 - __main__ - INFO - Added 20 stocks from page 4 (total: 80)
2025-03-16 18:15:44,467 - __main__ - INFO - Waiting 3.27 seconds before next page...
2025-03-16 18:30:07,458 - __main__ - INFO - Table stock_quotes created or already exists
2025-03-16 18:30:07,459 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-03-16 18:30:07,459 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-03-16 18:30:10,576 - __main__ - INFO - Successfully fetched page, length: 167478
2025-03-16 18:30:10,665 - __main__ - INFO - Found 23 tables in the document
2025-03-16 18:30:10,665 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-03-16 18:30:10,665 - __main__ - INFO - Found 20 data rows
2025-03-16 18:30:10,667 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-03-16 18:30:10,667 - __main__ - INFO - Extracted data for 20 stocks
2025-03-16 18:30:10,672 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-03-16 18:30:10,672 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-03-16 18:30:10,672 - __main__ - INFO - Scraping completed. Total stocks: 20
2025-03-16 18:30:10,672 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 20
2025-03-16 18:34:25,459 - __main__ - INFO - Table stock_quotes created or already exists
2025-03-16 18:34:25,459 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-03-16 18:34:25,459 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-03-16 18:34:26,937 - __main__ - INFO - Successfully fetched page, length: 167488
2025-03-16 18:34:27,027 - __main__ - INFO - Found 23 tables in the document
2025-03-16 18:34:27,027 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-03-16 18:34:27,027 - __main__ - INFO - Found 20 data rows
2025-03-16 18:34:27,029 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-03-16 18:34:27,029 - __main__ - INFO - Extracted data for 20 stocks
2025-03-16 18:34:27,033 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-03-16 18:34:27,033 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-03-16 18:34:27,034 - __main__ - INFO - Waiting 3.83 seconds before next page...
2025-03-16 18:34:30,873 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-03-16 18:34:30,873 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-03-16 18:34:32,587 - __main__ - INFO - Successfully fetched page, length: 167633
2025-03-16 18:34:32,637 - __main__ - INFO - Found 23 tables in the document
2025-03-16 18:34:32,637 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-03-16 18:34:32,637 - __main__ - INFO - Found 20 data rows
2025-03-16 18:34:32,639 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-03-16 18:34:32,639 - __main__ - INFO - Extracted data for 20 stocks
2025-03-16 18:34:32,642 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-03-16 18:34:32,642 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-03-16 18:34:32,642 - __main__ - INFO - Waiting 2.89 seconds before next page...
2025-03-16 18:34:35,538 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-03-16 18:34:35,539 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-03-16 18:34:36,912 - __main__ - INFO - Successfully fetched page, length: 143193
2025-03-16 18:34:36,956 - __main__ - INFO - Found 23 tables in the document
2025-03-16 18:34:36,956 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-03-16 18:34:36,956 - __main__ - INFO - Found 10 data rows
2025-03-16 18:34:36,958 - __main__ - INFO - No 'next' link found.
2025-03-16 18:34:36,958 - __main__ - INFO - Extracted data for 10 stocks
2025-03-16 18:34:36,960 - __main__ - INFO - Successfully upserted data for 10 stocks
2025-03-16 18:34:36,961 - __main__ - INFO - Added 10 stocks from page 3 (total: 50)
2025-03-16 18:34:36,961 - __main__ - INFO - Scraping completed. Total stocks: 50
2025-03-16 18:34:36,961 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 50
2025-03-22 18:05:01,877 - __main__ - ERROR - Database connection error: connection to server at "localhost" (::1), port 5432 failed: FATAL:  role "postgres" does not exist

2025-03-22 18:05:01,878 - __main__ - ERROR - Error in scrape_finviz_stocks_with_options: connection to server at "localhost" (::1), port 5432 failed: FATAL:  role "postgres" does not exist

2025-03-22 18:05:01,878 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 0
2025-03-22 18:10:37,493 - __main__ - ERROR - Database connection error: connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "ananth" does not exist

2025-03-22 18:10:37,493 - __main__ - ERROR - Error in scrape_finviz_stocks_with_options: connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "ananth" does not exist

2025-03-22 18:10:37,493 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 0
2025-03-22 18:11:47,083 - __main__ - INFO - Table stock_quotes created or already exists
2025-03-22 18:11:47,083 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-03-22 18:11:47,083 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-03-22 18:11:49,805 - __main__ - INFO - Successfully fetched page, length: 167436
2025-03-22 18:11:49,876 - __main__ - INFO - Found 23 tables in the document
2025-03-22 18:11:49,876 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-03-22 18:11:49,876 - __main__ - INFO - Found 20 data rows
2025-03-22 18:11:49,878 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-03-22 18:11:49,878 - __main__ - INFO - Extracted data for 20 stocks
2025-03-22 18:11:49,884 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-03-22 18:11:49,884 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-03-22 18:11:49,884 - __main__ - INFO - Waiting 3.62 seconds before next page...
2025-03-22 18:11:53,507 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-03-22 18:11:53,507 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-03-22 18:11:56,516 - __main__ - INFO - Successfully fetched page, length: 167735
2025-03-22 18:11:56,565 - __main__ - INFO - Found 23 tables in the document
2025-03-22 18:11:56,566 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-03-22 18:11:56,566 - __main__ - INFO - Found 20 data rows
2025-03-22 18:11:56,568 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-03-22 18:11:56,568 - __main__ - INFO - Extracted data for 20 stocks
2025-03-22 18:11:56,571 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-03-22 18:11:56,571 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-03-22 18:11:56,571 - __main__ - INFO - Waiting 3.71 seconds before next page...
2025-03-22 18:12:00,287 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-03-22 18:12:00,287 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-03-22 18:12:03,194 - __main__ - INFO - Successfully fetched page, length: 143114
2025-03-22 18:12:03,238 - __main__ - INFO - Found 23 tables in the document
2025-03-22 18:12:03,238 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-03-22 18:12:03,238 - __main__ - INFO - Found 10 data rows
2025-03-22 18:12:03,240 - __main__ - INFO - No 'next' link found.
2025-03-22 18:12:03,240 - __main__ - INFO - Extracted data for 10 stocks
2025-03-22 18:12:03,243 - __main__ - INFO - Successfully upserted data for 10 stocks
2025-03-22 18:12:03,243 - __main__ - INFO - Added 10 stocks from page 3 (total: 50)
2025-03-22 18:12:03,243 - __main__ - INFO - Scraping completed. Total stocks: 50
2025-03-22 18:12:03,243 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 50
2025-03-23 11:13:24,628 - __main__ - INFO - Table stock_quotes created or already exists
2025-03-23 11:13:24,628 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-03-23 11:13:24,628 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-03-23 11:13:25,940 - __main__ - INFO - Successfully fetched page, length: 167436
2025-03-23 11:13:26,012 - __main__ - INFO - Found 23 tables in the document
2025-03-23 11:13:26,012 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-03-23 11:13:26,012 - __main__ - INFO - Found 20 data rows
2025-03-23 11:13:26,014 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-03-23 11:13:26,014 - __main__ - INFO - Extracted data for 20 stocks
2025-03-23 11:13:26,022 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-03-23 11:13:26,022 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-03-23 11:13:26,022 - __main__ - INFO - Waiting 2.43 seconds before next page...
2025-03-23 11:13:28,457 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-03-23 11:13:28,457 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-03-23 11:13:31,583 - __main__ - INFO - Successfully fetched page, length: 167735
2025-03-23 11:13:31,637 - __main__ - INFO - Found 23 tables in the document
2025-03-23 11:13:31,637 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-03-23 11:13:31,638 - __main__ - INFO - Found 20 data rows
2025-03-23 11:13:31,640 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-03-23 11:13:31,640 - __main__ - INFO - Extracted data for 20 stocks
2025-03-23 11:13:31,642 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-03-23 11:13:31,643 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-03-23 11:13:31,643 - __main__ - INFO - Waiting 3.22 seconds before next page...
2025-03-23 11:13:34,869 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-03-23 11:13:34,870 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-03-23 11:13:37,466 - __main__ - INFO - Successfully fetched page, length: 143114
2025-03-23 11:13:37,516 - __main__ - INFO - Found 23 tables in the document
2025-03-23 11:13:37,517 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-03-23 11:13:37,517 - __main__ - INFO - Found 10 data rows
2025-03-23 11:13:37,518 - __main__ - INFO - No 'next' link found.
2025-03-23 11:13:37,519 - __main__ - INFO - Extracted data for 10 stocks
2025-03-23 11:13:37,521 - __main__ - INFO - Successfully upserted data for 10 stocks
2025-03-23 11:13:37,522 - __main__ - INFO - Added 10 stocks from page 3 (total: 50)
2025-03-23 11:13:37,522 - __main__ - INFO - Scraping completed. Total stocks: 50
2025-03-23 11:13:37,522 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 50
2025-03-23 11:20:52,150 - __main__ - INFO - Table stock_quotes created or already exists
2025-03-23 11:20:52,151 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-03-23 11:20:52,152 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-03-23 11:20:55,032 - __main__ - INFO - Successfully fetched page, length: 167436
2025-03-23 11:20:55,098 - __main__ - INFO - Found 23 tables in the document
2025-03-23 11:20:55,098 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-03-23 11:20:55,098 - __main__ - INFO - Found 20 data rows
2025-03-23 11:20:55,100 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-03-23 11:20:55,100 - __main__ - INFO - Extracted data for 20 stocks
2025-03-23 11:20:55,229 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-03-23 11:20:55,229 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-03-23 11:20:55,229 - __main__ - INFO - Waiting 2.89 seconds before next page...
2025-03-23 11:20:58,129 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-03-23 11:20:58,129 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-03-23 11:20:59,805 - __main__ - INFO - Successfully fetched page, length: 167735
2025-03-23 11:20:59,859 - __main__ - INFO - Found 23 tables in the document
2025-03-23 11:20:59,859 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-03-23 11:20:59,859 - __main__ - INFO - Found 20 data rows
2025-03-23 11:20:59,861 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-03-23 11:20:59,861 - __main__ - INFO - Extracted data for 20 stocks
2025-03-23 11:20:59,978 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-03-23 11:20:59,978 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-03-23 11:20:59,978 - __main__ - INFO - Waiting 3.71 seconds before next page...
2025-03-23 11:21:03,694 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-03-23 11:21:03,694 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-03-23 11:21:05,205 - __main__ - INFO - Successfully fetched page, length: 143124
2025-03-23 11:21:05,251 - __main__ - INFO - Found 23 tables in the document
2025-03-23 11:21:05,252 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-03-23 11:21:05,252 - __main__ - INFO - Found 10 data rows
2025-03-23 11:21:05,253 - __main__ - INFO - No 'next' link found.
2025-03-23 11:21:05,253 - __main__ - INFO - Extracted data for 10 stocks
2025-03-23 11:21:05,380 - __main__ - INFO - Successfully upserted data for 10 stocks
2025-03-23 11:21:05,380 - __main__ - INFO - Added 10 stocks from page 3 (total: 50)
2025-03-23 11:21:05,380 - __main__ - INFO - Scraping completed. Total stocks: 50
2025-03-23 11:21:05,381 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 50
2025-07-06 15:42:53,577 - __main__ - INFO - Table stock_quotes created or already exists
2025-07-06 15:42:53,577 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-07-06 15:42:53,577 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=1
2025-07-06 15:42:55,031 - __main__ - INFO - Successfully fetched page, length: 162045
2025-07-06 15:42:55,122 - __main__ - INFO - Found 23 tables in the document
2025-07-06 15:42:55,122 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 15:42:55,122 - __main__ - INFO - Found 20 data rows
2025-07-06 15:42:55,124 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-07-06 15:42:55,124 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 15:42:55,132 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 15:42:55,132 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-07-06 15:42:55,132 - __main__ - INFO - Waiting 3.22 seconds before next page...
2025-07-06 15:42:58,361 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-07-06 15:42:58,361 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=21
2025-07-06 15:43:00,185 - __main__ - INFO - Successfully fetched page, length: 162509
2025-07-06 15:43:00,234 - __main__ - INFO - Found 23 tables in the document
2025-07-06 15:43:00,234 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 15:43:00,234 - __main__ - INFO - Found 20 data rows
2025-07-06 15:43:00,236 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-07-06 15:43:00,236 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 15:43:00,239 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 15:43:00,240 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-07-06 15:43:00,240 - __main__ - INFO - Waiting 3.17 seconds before next page...
2025-07-06 15:43:03,418 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-07-06 15:43:03,419 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_mega,sh_opt_option&r=41
2025-07-06 15:43:06,493 - __main__ - INFO - Successfully fetched page, length: 157499
2025-07-06 15:43:06,540 - __main__ - INFO - Found 23 tables in the document
2025-07-06 15:43:06,541 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 15:43:06,541 - __main__ - INFO - Found 18 data rows
2025-07-06 15:43:06,543 - __main__ - INFO - No 'next' link found.
2025-07-06 15:43:06,543 - __main__ - INFO - Extracted data for 18 stocks
2025-07-06 15:43:06,552 - __main__ - INFO - Successfully upserted data for 18 stocks
2025-07-06 15:43:06,552 - __main__ - INFO - Added 18 stocks from page 3 (total: 58)
2025-07-06 15:43:06,552 - __main__ - INFO - Scraping completed. Total stocks: 58
2025-07-06 15:43:06,552 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 58
2025-07-06 15:49:34,309 - __main__ - INFO - Table stock_quotes created or already exists
2025-07-06 15:49:34,310 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=1
2025-07-06 15:49:34,310 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=1
2025-07-06 15:49:37,276 - __main__ - INFO - Successfully fetched page, length: 172700
2025-07-06 15:49:37,365 - __main__ - INFO - Found 23 tables in the document
2025-07-06 15:49:37,365 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 15:49:37,366 - __main__ - INFO - Found 20 data rows
2025-07-06 15:49:37,367 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=sh_opt_option&r=21
2025-07-06 15:49:37,367 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 15:49:37,373 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 15:49:37,373 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-07-06 15:49:37,373 - __main__ - INFO - Waiting 3.15 seconds before next page...
2025-07-06 15:49:40,523 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=21
2025-07-06 15:49:40,524 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=21
2025-07-06 15:49:42,380 - __main__ - INFO - Successfully fetched page, length: 173018
2025-07-06 15:49:42,429 - __main__ - INFO - Found 23 tables in the document
2025-07-06 15:49:42,429 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 15:49:42,430 - __main__ - INFO - Found 20 data rows
2025-07-06 15:49:42,432 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=sh_opt_option&r=41
2025-07-06 15:49:42,432 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 15:49:42,435 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 15:49:42,435 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-07-06 15:49:42,435 - __main__ - INFO - Waiting 3.73 seconds before next page...
2025-07-06 15:49:46,170 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=41
2025-07-06 15:49:46,170 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=41
2025-07-06 15:49:49,009 - __main__ - INFO - Successfully fetched page, length: 173221
2025-07-06 15:49:49,062 - __main__ - INFO - Found 23 tables in the document
2025-07-06 15:49:49,062 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 15:49:49,062 - __main__ - INFO - Found 20 data rows
2025-07-06 15:49:49,064 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=sh_opt_option&r=61
2025-07-06 15:49:49,064 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 15:49:49,068 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 15:49:49,068 - __main__ - INFO - Added 20 stocks from page 3 (total: 60)
2025-07-06 15:49:49,068 - __main__ - INFO - Waiting 2.26 seconds before next page...
2025-07-06 15:49:51,334 - __main__ - INFO - Scraping page 4: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=61
2025-07-06 15:49:51,334 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=61
2025-07-06 15:49:52,898 - __main__ - INFO - Successfully fetched page, length: 173048
2025-07-06 15:49:52,971 - __main__ - INFO - Found 23 tables in the document
2025-07-06 15:49:52,971 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 15:49:52,971 - __main__ - INFO - Found 20 data rows
2025-07-06 15:49:52,973 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=sh_opt_option&r=81
2025-07-06 15:49:52,973 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 15:49:52,977 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 15:49:52,977 - __main__ - INFO - Added 20 stocks from page 4 (total: 80)
2025-07-06 15:49:52,977 - __main__ - INFO - Waiting 3.37 seconds before next page...
2025-07-06 15:49:56,357 - __main__ - INFO - Scraping page 5: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=81
2025-07-06 15:49:56,357 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=81
2025-07-06 15:49:58,596 - __main__ - INFO - Successfully fetched page, length: 173760
2025-07-06 15:49:58,633 - __main__ - INFO - Found 23 tables in the document
2025-07-06 15:49:58,633 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 15:49:58,633 - __main__ - INFO - Found 20 data rows
2025-07-06 15:49:58,635 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=sh_opt_option&r=101
2025-07-06 15:49:58,635 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 15:49:58,637 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 15:49:58,637 - __main__ - INFO - Added 20 stocks from page 5 (total: 100)
2025-07-06 15:49:58,637 - __main__ - INFO - Waiting 3.79 seconds before next page...
2025-07-06 15:50:02,433 - __main__ - INFO - Scraping page 6: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=101
2025-07-06 15:50:02,433 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=101
2025-07-06 15:50:04,228 - __main__ - INFO - Successfully fetched page, length: 173660
2025-07-06 15:50:04,267 - __main__ - INFO - Found 23 tables in the document
2025-07-06 15:50:04,267 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 15:50:04,268 - __main__ - INFO - Found 20 data rows
2025-07-06 15:50:04,270 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=sh_opt_option&r=121
2025-07-06 15:50:04,270 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 15:50:04,275 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 15:50:04,275 - __main__ - INFO - Added 20 stocks from page 6 (total: 120)
2025-07-06 15:50:04,275 - __main__ - INFO - Waiting 3.53 seconds before next page...
2025-07-06 15:50:07,812 - __main__ - INFO - Scraping page 7: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=121
2025-07-06 15:50:07,812 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=121
2025-07-06 15:50:10,556 - __main__ - INFO - Successfully fetched page, length: 173522
2025-07-06 15:50:10,608 - __main__ - INFO - Found 23 tables in the document
2025-07-06 15:50:10,609 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 15:50:10,609 - __main__ - INFO - Found 20 data rows
2025-07-06 15:50:10,611 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=sh_opt_option&r=141
2025-07-06 15:50:10,611 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 15:50:10,614 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 15:50:10,614 - __main__ - INFO - Added 20 stocks from page 7 (total: 140)
2025-07-06 15:50:10,614 - __main__ - INFO - Waiting 2.09 seconds before next page...
2025-07-06 15:50:12,707 - __main__ - INFO - Scraping page 8: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=141
2025-07-06 15:50:12,707 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=141
2025-07-06 15:50:14,205 - __main__ - INFO - Successfully fetched page, length: 174145
2025-07-06 15:50:14,245 - __main__ - INFO - Found 23 tables in the document
2025-07-06 15:50:14,245 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 15:50:14,245 - __main__ - INFO - Found 20 data rows
2025-07-06 15:50:14,246 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=sh_opt_option&r=161
2025-07-06 15:50:14,247 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 15:50:14,272 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 15:50:14,272 - __main__ - INFO - Added 20 stocks from page 8 (total: 160)
2025-07-06 15:50:14,272 - __main__ - INFO - Waiting 2.44 seconds before next page...
2025-07-06 15:50:16,721 - __main__ - INFO - Scraping page 9: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=161
2025-07-06 15:50:16,721 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=161
2025-07-06 15:50:19,410 - __main__ - INFO - Successfully fetched page, length: 173451
2025-07-06 15:50:19,463 - __main__ - INFO - Found 23 tables in the document
2025-07-06 15:50:19,463 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 15:50:19,463 - __main__ - INFO - Found 20 data rows
2025-07-06 15:50:19,465 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=sh_opt_option&r=181
2025-07-06 15:50:19,465 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 15:50:19,467 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 15:50:19,467 - __main__ - INFO - Added 20 stocks from page 9 (total: 180)
2025-07-06 15:50:19,467 - __main__ - INFO - Waiting 3.78 seconds before next page...
2025-07-06 15:50:23,253 - __main__ - INFO - Scraping page 10: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=181
2025-07-06 15:50:23,254 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=sh_opt_option&r=181
2025-07-06 15:50:25,181 - __main__ - INFO - Successfully fetched page, length: 173559
2025-07-06 15:50:25,237 - __main__ - INFO - Found 23 tables in the document
2025-07-06 15:50:25,238 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 15:50:25,238 - __main__ - INFO - Found 20 data rows
2025-07-06 15:50:25,240 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=sh_opt_option&r=201
2025-07-06 15:50:25,240 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 15:50:25,244 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 15:50:25,244 - __main__ - INFO - Added 20 stocks from page 10 (total: 200)
2025-07-06 15:50:25,244 - __main__ - INFO - Waiting 2.23 seconds before next page...
2025-07-06 15:50:27,475 - __main__ - INFO - Scraping completed. Total stocks: 200
2025-07-06 15:50:27,476 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 200
2025-07-06 15:59:34,687 - __main__ - INFO - Table stock_quotes created or already exists
2025-07-06 15:59:34,688 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_largeover%2Cfa_eps5years_o10%2Cfa_grossmargin_o25%2Cfa_pfcf_u50%2Cfa_sales5years_o10%2Csh_opt_option%2Cta_sma50_pa&ft=2&o=-perf3y&r=1
2025-07-06 15:59:34,688 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover%2Cfa_eps5years_o10%2Cfa_grossmargin_o25%2Cfa_pfcf_u50%2Cfa_sales5years_o10%2Csh_opt_option%2Cta_sma50_pa&ft=2&o=-perf3y&r=1
2025-07-06 15:59:36,649 - __main__ - INFO - Successfully fetched page, length: 203972
2025-07-06 15:59:36,729 - __main__ - INFO - Found 15 tables in the document
2025-07-06 15:59:36,729 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 15:59:36,729 - __main__ - INFO - Found 20 data rows
2025-07-06 15:59:36,731 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_pfcf_u50,fa_sales5years_o10,sh_opt_option,ta_sma50_pa&ft=2&o=-perf3y&r=21
2025-07-06 15:59:36,731 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 15:59:36,737 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 15:59:36,737 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-07-06 15:59:36,737 - __main__ - INFO - Waiting 2.39 seconds before next page...
2025-07-06 15:59:39,134 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_pfcf_u50,fa_sales5years_o10,sh_opt_option,ta_sma50_pa&ft=2&o=-perf3y&r=21
2025-07-06 15:59:39,134 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_pfcf_u50,fa_sales5years_o10,sh_opt_option,ta_sma50_pa&ft=2&o=-perf3y&r=21
2025-07-06 15:59:42,129 - __main__ - INFO - Successfully fetched page, length: 204536
2025-07-06 15:59:42,185 - __main__ - INFO - Found 15 tables in the document
2025-07-06 15:59:42,185 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 15:59:42,186 - __main__ - INFO - Found 20 data rows
2025-07-06 15:59:42,188 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_pfcf_u50,fa_sales5years_o10,sh_opt_option,ta_sma50_pa&ft=2&o=-perf3y&r=41
2025-07-06 15:59:42,188 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 15:59:42,192 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 15:59:42,192 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-07-06 15:59:42,192 - __main__ - INFO - Waiting 2.41 seconds before next page...
2025-07-06 15:59:44,610 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_pfcf_u50,fa_sales5years_o10,sh_opt_option,ta_sma50_pa&ft=2&o=-perf3y&r=41
2025-07-06 15:59:44,611 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_pfcf_u50,fa_sales5years_o10,sh_opt_option,ta_sma50_pa&ft=2&o=-perf3y&r=41
2025-07-06 15:59:47,605 - __main__ - INFO - Successfully fetched page, length: 204567
2025-07-06 15:59:47,648 - __main__ - INFO - Found 15 tables in the document
2025-07-06 15:59:47,648 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 15:59:47,648 - __main__ - INFO - Found 20 data rows
2025-07-06 15:59:47,650 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_pfcf_u50,fa_sales5years_o10,sh_opt_option,ta_sma50_pa&ft=2&o=-perf3y&r=61
2025-07-06 15:59:47,650 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 15:59:47,651 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 15:59:47,651 - __main__ - INFO - Added 20 stocks from page 3 (total: 60)
2025-07-06 15:59:47,651 - __main__ - INFO - Waiting 3.46 seconds before next page...
2025-07-06 15:59:51,115 - __main__ - INFO - Scraping page 4: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_pfcf_u50,fa_sales5years_o10,sh_opt_option,ta_sma50_pa&ft=2&o=-perf3y&r=61
2025-07-06 15:59:51,116 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_pfcf_u50,fa_sales5years_o10,sh_opt_option,ta_sma50_pa&ft=2&o=-perf3y&r=61
2025-07-06 15:59:52,754 - __main__ - INFO - Successfully fetched page, length: 161049
2025-07-06 15:59:52,828 - __main__ - INFO - Found 15 tables in the document
2025-07-06 15:59:52,828 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 15:59:52,829 - __main__ - INFO - Found 1 data rows
2025-07-06 15:59:52,830 - __main__ - INFO - No 'next' link found.
2025-07-06 15:59:52,830 - __main__ - INFO - Extracted data for 1 stocks
2025-07-06 15:59:52,832 - __main__ - INFO - Successfully upserted data for 1 stocks
2025-07-06 15:59:52,832 - __main__ - INFO - Added 1 stocks from page 4 (total: 61)
2025-07-06 15:59:52,832 - __main__ - INFO - Scraping completed. Total stocks: 61
2025-07-06 15:59:52,832 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 61
2025-07-06 16:02:11,190 - __main__ - INFO - Table stock_quotes created or already exists
2025-07-06 16:02:11,190 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_sales5years_o10,sh_opt_option&ft=2&o=-perf3y#google_vignette&r=1
2025-07-06 16:02:11,190 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_sales5years_o10,sh_opt_option&ft=2&o=-perf3y#google_vignette&r=1
2025-07-06 16:02:14,076 - __main__ - INFO - Successfully fetched page, length: 197471
2025-07-06 16:02:14,140 - __main__ - INFO - Found 15 tables in the document
2025-07-06 16:02:14,140 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 16:02:14,140 - __main__ - INFO - Found 20 data rows
2025-07-06 16:02:14,142 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_sales5years_o10,sh_opt_option&ft=2&o=-perf3y&r=21
2025-07-06 16:02:14,142 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 16:02:14,144 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 16:02:14,144 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-07-06 16:02:14,144 - __main__ - INFO - Waiting 2.18 seconds before next page...
2025-07-06 16:02:16,325 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_sales5years_o10,sh_opt_option&ft=2&o=-perf3y&r=21
2025-07-06 16:02:16,325 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_sales5years_o10,sh_opt_option&ft=2&o=-perf3y&r=21
2025-07-06 16:02:18,256 - __main__ - INFO - Successfully fetched page, length: 198114
2025-07-06 16:02:18,317 - __main__ - INFO - Found 15 tables in the document
2025-07-06 16:02:18,317 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 16:02:18,317 - __main__ - INFO - Found 20 data rows
2025-07-06 16:02:18,319 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_sales5years_o10,sh_opt_option&ft=2&o=-perf3y&r=41
2025-07-06 16:02:18,319 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 16:02:18,323 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 16:02:18,323 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-07-06 16:02:18,323 - __main__ - INFO - Waiting 3.27 seconds before next page...
2025-07-06 16:02:21,594 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_sales5years_o10,sh_opt_option&ft=2&o=-perf3y&r=41
2025-07-06 16:02:21,594 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_sales5years_o10,sh_opt_option&ft=2&o=-perf3y&r=41
2025-07-06 16:02:23,574 - __main__ - INFO - Successfully fetched page, length: 197866
2025-07-06 16:02:23,621 - __main__ - INFO - Found 15 tables in the document
2025-07-06 16:02:23,621 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 16:02:23,621 - __main__ - INFO - Found 20 data rows
2025-07-06 16:02:23,623 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_sales5years_o10,sh_opt_option&ft=2&o=-perf3y&r=61
2025-07-06 16:02:23,623 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 16:02:23,626 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 16:02:23,626 - __main__ - INFO - Added 20 stocks from page 3 (total: 60)
2025-07-06 16:02:23,626 - __main__ - INFO - Waiting 3.26 seconds before next page...
2025-07-06 16:02:26,894 - __main__ - INFO - Scraping page 4: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_sales5years_o10,sh_opt_option&ft=2&o=-perf3y&r=61
2025-07-06 16:02:26,895 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_sales5years_o10,sh_opt_option&ft=2&o=-perf3y&r=61
2025-07-06 16:02:28,222 - __main__ - INFO - Successfully fetched page, length: 198265
2025-07-06 16:02:28,288 - __main__ - INFO - Found 15 tables in the document
2025-07-06 16:02:28,288 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 16:02:28,288 - __main__ - INFO - Found 20 data rows
2025-07-06 16:02:28,290 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_sales5years_o10,sh_opt_option&ft=2&o=-perf3y&r=81
2025-07-06 16:02:28,290 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 16:02:28,295 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 16:02:28,295 - __main__ - INFO - Added 20 stocks from page 4 (total: 80)
2025-07-06 16:02:28,295 - __main__ - INFO - Waiting 2.14 seconds before next page...
2025-07-06 16:02:30,443 - __main__ - INFO - Scraping page 5: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_sales5years_o10,sh_opt_option&ft=2&o=-perf3y&r=81
2025-07-06 16:02:30,443 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_sales5years_o10,sh_opt_option&ft=2&o=-perf3y&r=81
2025-07-06 16:02:33,252 - __main__ - INFO - Successfully fetched page, length: 197952
2025-07-06 16:02:33,295 - __main__ - INFO - Found 15 tables in the document
2025-07-06 16:02:33,295 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 16:02:33,296 - __main__ - INFO - Found 20 data rows
2025-07-06 16:02:33,298 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_sales5years_o10,sh_opt_option&ft=2&o=-perf3y&r=101
2025-07-06 16:02:33,298 - __main__ - INFO - Extracted data for 20 stocks
2025-07-06 16:02:33,318 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-07-06 16:02:33,319 - __main__ - INFO - Added 20 stocks from page 5 (total: 100)
2025-07-06 16:02:33,319 - __main__ - INFO - Waiting 2.22 seconds before next page...
2025-07-06 16:02:35,545 - __main__ - INFO - Scraping page 6: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_sales5years_o10,sh_opt_option&ft=2&o=-perf3y&r=101
2025-07-06 16:02:35,545 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_grossmargin_o25,fa_sales5years_o10,sh_opt_option&ft=2&o=-perf3y&r=101
2025-07-06 16:02:37,370 - __main__ - INFO - Successfully fetched page, length: 175034
2025-07-06 16:02:37,410 - __main__ - INFO - Found 15 tables in the document
2025-07-06 16:02:37,410 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-07-06 16:02:37,410 - __main__ - INFO - Found 10 data rows
2025-07-06 16:02:37,412 - __main__ - INFO - No 'next' link found.
2025-07-06 16:02:37,412 - __main__ - INFO - Extracted data for 10 stocks
2025-07-06 16:02:37,454 - __main__ - INFO - Successfully upserted data for 10 stocks
2025-07-06 16:02:37,454 - __main__ - INFO - Added 10 stocks from page 6 (total: 110)
2025-07-06 16:02:37,454 - __main__ - INFO - Scraping completed. Total stocks: 110
2025-07-06 16:02:37,454 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 110
=======
2025-04-19 14:11:20,749 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 0
2025-04-19 14:18:02,328 - __main__ - INFO - Table stock_quotes created or already exists
2025-04-19 14:18:02,329 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=1
2025-04-19 14:18:02,329 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=1
2025-04-19 14:18:04,201 - __main__ - INFO - Successfully fetched page, length: 174282
2025-04-19 14:18:04,285 - __main__ - INFO - Found 23 tables in the document
2025-04-19 14:18:04,285 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-19 14:18:04,285 - __main__ - INFO - Found 20 data rows
2025-04-19 14:18:04,287 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=21
2025-04-19 14:18:04,287 - __main__ - INFO - Extracted data for 20 stocks
2025-04-19 14:18:04,387 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-19 14:18:04,387 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-04-19 14:18:04,388 - __main__ - INFO - Waiting 3.64 seconds before next page...
2025-04-19 14:18:08,028 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=21
2025-04-19 14:18:08,028 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=21
2025-04-19 14:18:11,000 - __main__ - INFO - Successfully fetched page, length: 174832
2025-04-19 14:18:11,055 - __main__ - INFO - Found 23 tables in the document
2025-04-19 14:18:11,055 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-19 14:18:11,055 - __main__ - INFO - Found 20 data rows
2025-04-19 14:18:11,057 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=41
2025-04-19 14:18:11,057 - __main__ - INFO - Extracted data for 20 stocks
2025-04-19 14:18:11,163 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-19 14:18:11,163 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-04-19 14:18:11,163 - __main__ - INFO - Waiting 3.09 seconds before next page...
2025-04-19 14:18:14,259 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=41
2025-04-19 14:18:14,259 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=41
2025-04-19 14:18:16,736 - __main__ - INFO - Successfully fetched page, length: 174747
2025-04-19 14:18:16,793 - __main__ - INFO - Found 23 tables in the document
2025-04-19 14:18:16,793 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-19 14:18:16,793 - __main__ - INFO - Found 20 data rows
2025-04-19 14:18:16,795 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=61
2025-04-19 14:18:16,795 - __main__ - INFO - Extracted data for 20 stocks
2025-04-19 14:18:16,891 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-19 14:18:16,891 - __main__ - INFO - Added 20 stocks from page 3 (total: 60)
2025-04-19 14:18:16,891 - __main__ - INFO - Waiting 2.98 seconds before next page...
2025-04-19 14:18:19,870 - __main__ - INFO - Scraping page 4: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=61
2025-04-19 14:18:19,872 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=61
2025-04-19 14:18:22,197 - __main__ - INFO - Successfully fetched page, length: 175080
2025-04-19 14:18:22,252 - __main__ - INFO - Found 23 tables in the document
2025-04-19 14:18:22,252 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-19 14:18:22,253 - __main__ - INFO - Found 20 data rows
2025-04-19 14:18:22,255 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=81
2025-04-19 14:18:22,255 - __main__ - INFO - Extracted data for 20 stocks
2025-04-19 14:18:22,339 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-19 14:18:22,339 - __main__ - INFO - Added 20 stocks from page 4 (total: 80)
2025-04-19 14:18:22,339 - __main__ - INFO - Waiting 3.97 seconds before next page...
2025-04-19 14:18:26,314 - __main__ - INFO - Scraping page 5: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=81
2025-04-19 14:18:26,314 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=81
2025-04-19 14:18:27,857 - __main__ - INFO - Successfully fetched page, length: 175448
2025-04-19 14:18:27,912 - __main__ - INFO - Found 23 tables in the document
2025-04-19 14:18:27,912 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-19 14:18:27,912 - __main__ - INFO - Found 20 data rows
2025-04-19 14:18:27,914 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=101
2025-04-19 14:18:27,914 - __main__ - INFO - Extracted data for 20 stocks
2025-04-19 14:18:28,004 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-19 14:18:28,004 - __main__ - INFO - Added 20 stocks from page 5 (total: 100)
2025-04-19 14:18:28,004 - __main__ - INFO - Waiting 3.49 seconds before next page...
2025-04-19 14:18:31,499 - __main__ - INFO - Scraping page 6: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=101
2025-04-19 14:18:31,500 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=101
2025-04-19 14:18:32,926 - __main__ - INFO - Successfully fetched page, length: 175256
2025-04-19 14:18:33,002 - __main__ - INFO - Found 23 tables in the document
2025-04-19 14:18:33,002 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-19 14:18:33,002 - __main__ - INFO - Found 20 data rows
2025-04-19 14:18:33,004 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=121
2025-04-19 14:18:33,004 - __main__ - INFO - Extracted data for 20 stocks
2025-04-19 14:18:33,091 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-19 14:18:33,091 - __main__ - INFO - Added 20 stocks from page 6 (total: 120)
2025-04-19 14:18:33,091 - __main__ - INFO - Waiting 2.12 seconds before next page...
2025-04-19 14:18:35,212 - __main__ - INFO - Scraping page 7: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=121
2025-04-19 14:18:35,212 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=121
2025-04-19 14:18:38,198 - __main__ - INFO - Successfully fetched page, length: 175628
2025-04-19 14:18:38,253 - __main__ - INFO - Found 23 tables in the document
2025-04-19 14:18:38,253 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-19 14:18:38,253 - __main__ - INFO - Found 20 data rows
2025-04-19 14:18:38,255 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=141
2025-04-19 14:18:38,255 - __main__ - INFO - Extracted data for 20 stocks
2025-04-19 14:18:38,371 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-19 14:18:38,371 - __main__ - INFO - Added 20 stocks from page 7 (total: 140)
2025-04-19 14:18:38,371 - __main__ - INFO - Waiting 3.60 seconds before next page...
2025-04-19 14:18:41,973 - __main__ - INFO - Scraping page 8: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=141
2025-04-19 14:18:41,974 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=141
2025-04-19 14:18:45,204 - __main__ - INFO - Successfully fetched page, length: 175496
2025-04-19 14:18:45,259 - __main__ - INFO - Found 23 tables in the document
2025-04-19 14:18:45,259 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-19 14:18:45,260 - __main__ - INFO - Found 20 data rows
2025-04-19 14:18:45,262 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=161
2025-04-19 14:18:45,262 - __main__ - INFO - Extracted data for 20 stocks
2025-04-19 14:18:45,352 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-19 14:18:45,352 - __main__ - INFO - Added 20 stocks from page 8 (total: 160)
2025-04-19 14:18:45,352 - __main__ - INFO - Waiting 2.26 seconds before next page...
2025-04-19 14:18:47,617 - __main__ - INFO - Scraping page 9: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=161
2025-04-19 14:18:47,617 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=161
2025-04-19 14:18:50,178 - __main__ - INFO - Successfully fetched page, length: 175186
2025-04-19 14:18:50,232 - __main__ - INFO - Found 23 tables in the document
2025-04-19 14:18:50,233 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-19 14:18:50,233 - __main__ - INFO - Found 20 data rows
2025-04-19 14:18:50,235 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=181
2025-04-19 14:18:50,235 - __main__ - INFO - Extracted data for 20 stocks
2025-04-19 14:18:50,333 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-19 14:18:50,333 - __main__ - INFO - Added 20 stocks from page 9 (total: 180)
2025-04-19 14:18:50,333 - __main__ - INFO - Waiting 2.85 seconds before next page...
2025-04-19 14:18:53,190 - __main__ - INFO - Scraping page 10: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=181
2025-04-19 14:18:53,190 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=181
2025-04-19 14:18:54,953 - __main__ - INFO - Successfully fetched page, length: 175291
2025-04-19 14:18:55,011 - __main__ - INFO - Found 23 tables in the document
2025-04-19 14:18:55,011 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-19 14:18:55,011 - __main__ - INFO - Found 20 data rows
2025-04-19 14:18:55,013 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=201
2025-04-19 14:18:55,013 - __main__ - INFO - Extracted data for 20 stocks
2025-04-19 14:18:55,112 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-19 14:18:55,112 - __main__ - INFO - Added 20 stocks from page 10 (total: 200)
2025-04-19 14:18:55,112 - __main__ - INFO - Waiting 3.53 seconds before next page...
2025-04-19 14:18:58,650 - __main__ - INFO - Scraping completed. Total stocks: 200
2025-04-19 14:18:58,651 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 200
2025-04-24 07:53:57,722 - __main__ - INFO - Table stock_quotes created or already exists
2025-04-24 07:53:57,724 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=1
2025-04-24 07:53:57,724 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=1
2025-04-24 07:53:59,519 - __main__ - INFO - Successfully fetched page, length: 174393
2025-04-24 07:53:59,614 - __main__ - INFO - Found 23 tables in the document
2025-04-24 07:53:59,614 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-24 07:53:59,614 - __main__ - INFO - Found 20 data rows
2025-04-24 07:53:59,616 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=21
2025-04-24 07:53:59,616 - __main__ - INFO - Extracted data for 20 stocks
2025-04-24 07:53:59,744 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-24 07:53:59,745 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-04-24 07:53:59,745 - __main__ - INFO - Waiting 2.50 seconds before next page...
2025-04-24 07:54:02,245 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=21
2025-04-24 07:54:02,246 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=21
2025-04-24 07:54:04,524 - __main__ - INFO - Successfully fetched page, length: 175051
2025-04-24 07:54:04,593 - __main__ - INFO - Found 23 tables in the document
2025-04-24 07:54:04,593 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-24 07:54:04,593 - __main__ - INFO - Found 20 data rows
2025-04-24 07:54:04,596 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=41
2025-04-24 07:54:04,596 - __main__ - INFO - Extracted data for 20 stocks
2025-04-24 07:54:04,715 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-24 07:54:04,715 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-04-24 07:54:04,716 - __main__ - INFO - Waiting 2.85 seconds before next page...
2025-04-24 07:54:07,570 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=41
2025-04-24 07:54:07,571 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=41
2025-04-24 07:54:09,139 - __main__ - INFO - Successfully fetched page, length: 174998
2025-04-24 07:54:09,193 - __main__ - INFO - Found 23 tables in the document
2025-04-24 07:54:09,193 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-24 07:54:09,194 - __main__ - INFO - Found 20 data rows
2025-04-24 07:54:09,196 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=61
2025-04-24 07:54:09,196 - __main__ - INFO - Extracted data for 20 stocks
2025-04-24 07:54:09,305 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-24 07:54:09,305 - __main__ - INFO - Added 20 stocks from page 3 (total: 60)
2025-04-24 07:54:09,305 - __main__ - INFO - Waiting 2.09 seconds before next page...
2025-04-24 07:54:11,402 - __main__ - INFO - Scraping page 4: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=61
2025-04-24 07:54:11,402 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=61
2025-04-24 07:54:13,652 - __main__ - INFO - Successfully fetched page, length: 175067
2025-04-24 07:54:13,706 - __main__ - INFO - Found 23 tables in the document
2025-04-24 07:54:13,706 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-24 07:54:13,707 - __main__ - INFO - Found 20 data rows
2025-04-24 07:54:13,709 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=81
2025-04-24 07:54:13,709 - __main__ - INFO - Extracted data for 20 stocks
2025-04-24 07:54:13,824 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-24 07:54:13,824 - __main__ - INFO - Added 20 stocks from page 4 (total: 80)
2025-04-24 07:54:13,824 - __main__ - INFO - Waiting 3.96 seconds before next page...
2025-04-24 07:54:17,788 - __main__ - INFO - Scraping page 5: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=81
2025-04-24 07:54:17,788 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=81
2025-04-24 07:54:19,544 - __main__ - INFO - Successfully fetched page, length: 175700
2025-04-24 07:54:19,600 - __main__ - INFO - Found 23 tables in the document
2025-04-24 07:54:19,600 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-24 07:54:19,600 - __main__ - INFO - Found 20 data rows
2025-04-24 07:54:19,602 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=101
2025-04-24 07:54:19,602 - __main__ - INFO - Extracted data for 20 stocks
2025-04-24 07:54:19,710 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-24 07:54:19,710 - __main__ - INFO - Added 20 stocks from page 5 (total: 100)
2025-04-24 07:54:19,710 - __main__ - INFO - Waiting 2.33 seconds before next page...
2025-04-24 07:54:22,044 - __main__ - INFO - Scraping page 6: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=101
2025-04-24 07:54:22,045 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=101
2025-04-24 07:54:24,950 - __main__ - INFO - Successfully fetched page, length: 175522
2025-04-24 07:54:25,024 - __main__ - INFO - Found 23 tables in the document
2025-04-24 07:54:25,024 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-24 07:54:25,024 - __main__ - INFO - Found 20 data rows
2025-04-24 07:54:25,026 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=121
2025-04-24 07:54:25,026 - __main__ - INFO - Extracted data for 20 stocks
2025-04-24 07:54:25,146 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-24 07:54:25,146 - __main__ - INFO - Added 20 stocks from page 6 (total: 120)
2025-04-24 07:54:25,146 - __main__ - INFO - Waiting 3.36 seconds before next page...
2025-04-24 07:54:28,511 - __main__ - INFO - Scraping page 7: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=121
2025-04-24 07:54:28,512 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=121
2025-04-24 07:54:31,233 - __main__ - INFO - Successfully fetched page, length: 175573
2025-04-24 07:54:31,289 - __main__ - INFO - Found 23 tables in the document
2025-04-24 07:54:31,289 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-24 07:54:31,289 - __main__ - INFO - Found 20 data rows
2025-04-24 07:54:31,291 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=141
2025-04-24 07:54:31,291 - __main__ - INFO - Extracted data for 20 stocks
2025-04-24 07:54:31,408 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-24 07:54:31,408 - __main__ - INFO - Added 20 stocks from page 7 (total: 140)
2025-04-24 07:54:31,408 - __main__ - INFO - Waiting 2.70 seconds before next page...
2025-04-24 07:54:34,116 - __main__ - INFO - Scraping page 8: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=141
2025-04-24 07:54:34,116 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=141
2025-04-24 07:54:36,760 - __main__ - INFO - Successfully fetched page, length: 175665
2025-04-24 07:54:36,819 - __main__ - INFO - Found 23 tables in the document
2025-04-24 07:54:36,819 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-24 07:54:36,820 - __main__ - INFO - Found 20 data rows
2025-04-24 07:54:36,822 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=161
2025-04-24 07:54:36,822 - __main__ - INFO - Extracted data for 20 stocks
2025-04-24 07:54:36,933 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-24 07:54:36,933 - __main__ - INFO - Added 20 stocks from page 8 (total: 160)
2025-04-24 07:54:36,933 - __main__ - INFO - Waiting 3.27 seconds before next page...
2025-04-24 07:54:40,207 - __main__ - INFO - Scraping page 9: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=161
2025-04-24 07:54:40,208 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=161
2025-04-24 07:54:42,720 - __main__ - INFO - Successfully fetched page, length: 175592
2025-04-24 07:54:42,786 - __main__ - INFO - Found 23 tables in the document
2025-04-24 07:54:42,786 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-24 07:54:42,786 - __main__ - INFO - Found 20 data rows
2025-04-24 07:54:42,788 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=181
2025-04-24 07:54:42,788 - __main__ - INFO - Extracted data for 20 stocks
2025-04-24 07:54:42,907 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-24 07:54:42,907 - __main__ - INFO - Added 20 stocks from page 9 (total: 180)
2025-04-24 07:54:42,907 - __main__ - INFO - Waiting 2.18 seconds before next page...
2025-04-24 07:54:45,092 - __main__ - INFO - Scraping page 10: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=181
2025-04-24 07:54:45,092 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=181
2025-04-24 07:54:47,063 - __main__ - INFO - Successfully fetched page, length: 175369
2025-04-24 07:54:47,132 - __main__ - INFO - Found 23 tables in the document
2025-04-24 07:54:47,132 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-24 07:54:47,133 - __main__ - INFO - Found 20 data rows
2025-04-24 07:54:47,135 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=201
2025-04-24 07:54:47,137 - __main__ - INFO - Extracted data for 20 stocks
2025-04-24 07:54:47,251 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-24 07:54:47,251 - __main__ - INFO - Added 20 stocks from page 10 (total: 200)
2025-04-24 07:54:47,251 - __main__ - INFO - Waiting 2.44 seconds before next page...
2025-04-24 07:54:49,693 - __main__ - INFO - Scraping completed. Total stocks: 200
2025-04-24 07:54:49,694 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 200
2025-04-27 11:05:45,867 - __main__ - INFO - Table stock_quotes created or already exists
2025-04-27 11:05:45,869 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=1
2025-04-27 11:05:45,869 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=1
2025-04-27 11:05:47,186 - __main__ - INFO - Successfully fetched page, length: 174395
2025-04-27 11:05:47,257 - __main__ - INFO - Found 23 tables in the document
2025-04-27 11:05:47,257 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-27 11:05:47,257 - __main__ - INFO - Found 20 data rows
2025-04-27 11:05:47,259 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=21
2025-04-27 11:05:47,259 - __main__ - INFO - Extracted data for 20 stocks
2025-04-27 11:05:47,387 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-27 11:05:47,387 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-04-27 11:05:47,387 - __main__ - INFO - Waiting 2.47 seconds before next page...
2025-04-27 11:05:49,861 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=21
2025-04-27 11:05:49,862 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=21
2025-04-27 11:05:51,974 - __main__ - INFO - Successfully fetched page, length: 174959
2025-04-27 11:05:52,028 - __main__ - INFO - Found 23 tables in the document
2025-04-27 11:05:52,028 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-27 11:05:52,028 - __main__ - INFO - Found 20 data rows
2025-04-27 11:05:52,030 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=41
2025-04-27 11:05:52,030 - __main__ - INFO - Extracted data for 20 stocks
2025-04-27 11:05:52,159 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-27 11:05:52,160 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-04-27 11:05:52,160 - __main__ - INFO - Waiting 2.71 seconds before next page...
2025-04-27 11:05:54,879 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=41
2025-04-27 11:05:54,879 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=41
2025-04-27 11:05:56,281 - __main__ - INFO - Successfully fetched page, length: 174877
2025-04-27 11:05:56,335 - __main__ - INFO - Found 23 tables in the document
2025-04-27 11:05:56,335 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-27 11:05:56,336 - __main__ - INFO - Found 20 data rows
2025-04-27 11:05:56,338 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=61
2025-04-27 11:05:56,338 - __main__ - INFO - Extracted data for 20 stocks
2025-04-27 11:05:56,468 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-27 11:05:56,468 - __main__ - INFO - Added 20 stocks from page 3 (total: 60)
2025-04-27 11:05:56,468 - __main__ - INFO - Waiting 2.98 seconds before next page...
2025-04-27 11:05:59,454 - __main__ - INFO - Scraping page 4: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=61
2025-04-27 11:05:59,455 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=61
2025-04-27 11:06:00,892 - __main__ - INFO - Successfully fetched page, length: 175061
2025-04-27 11:06:00,948 - __main__ - INFO - Found 23 tables in the document
2025-04-27 11:06:00,948 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-27 11:06:00,948 - __main__ - INFO - Found 20 data rows
2025-04-27 11:06:00,950 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=81
2025-04-27 11:06:00,950 - __main__ - INFO - Extracted data for 20 stocks
2025-04-27 11:06:01,089 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-27 11:06:01,089 - __main__ - INFO - Added 20 stocks from page 4 (total: 80)
2025-04-27 11:06:01,089 - __main__ - INFO - Waiting 2.67 seconds before next page...
2025-04-27 11:06:03,765 - __main__ - INFO - Scraping page 5: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=81
2025-04-27 11:06:03,765 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=81
2025-04-27 11:06:06,250 - __main__ - INFO - Successfully fetched page, length: 175586
2025-04-27 11:06:06,301 - __main__ - INFO - Found 23 tables in the document
2025-04-27 11:06:06,302 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-27 11:06:06,302 - __main__ - INFO - Found 20 data rows
2025-04-27 11:06:06,304 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=101
2025-04-27 11:06:06,304 - __main__ - INFO - Extracted data for 20 stocks
2025-04-27 11:06:06,419 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-27 11:06:06,419 - __main__ - INFO - Added 20 stocks from page 5 (total: 100)
2025-04-27 11:06:06,419 - __main__ - INFO - Waiting 3.24 seconds before next page...
2025-04-27 11:06:09,669 - __main__ - INFO - Scraping page 6: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=101
2025-04-27 11:06:09,669 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=101
2025-04-27 11:06:12,604 - __main__ - INFO - Successfully fetched page, length: 175689
2025-04-27 11:06:12,675 - __main__ - INFO - Found 23 tables in the document
2025-04-27 11:06:12,675 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-27 11:06:12,675 - __main__ - INFO - Found 20 data rows
2025-04-27 11:06:12,677 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=121
2025-04-27 11:06:12,677 - __main__ - INFO - Extracted data for 20 stocks
2025-04-27 11:06:12,791 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-27 11:06:12,791 - __main__ - INFO - Added 20 stocks from page 6 (total: 120)
2025-04-27 11:06:12,791 - __main__ - INFO - Waiting 2.65 seconds before next page...
2025-04-27 11:06:15,451 - __main__ - INFO - Scraping page 7: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=121
2025-04-27 11:06:15,451 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=121
2025-04-27 11:06:17,516 - __main__ - INFO - Successfully fetched page, length: 175476
2025-04-27 11:06:17,572 - __main__ - INFO - Found 23 tables in the document
2025-04-27 11:06:17,572 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-27 11:06:17,572 - __main__ - INFO - Found 20 data rows
2025-04-27 11:06:17,574 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=141
2025-04-27 11:06:17,574 - __main__ - INFO - Extracted data for 20 stocks
2025-04-27 11:06:17,697 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-27 11:06:17,697 - __main__ - INFO - Added 20 stocks from page 7 (total: 140)
2025-04-27 11:06:17,697 - __main__ - INFO - Waiting 3.64 seconds before next page...
2025-04-27 11:06:21,343 - __main__ - INFO - Scraping page 8: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=141
2025-04-27 11:06:21,344 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=141
2025-04-27 11:06:23,561 - __main__ - INFO - Successfully fetched page, length: 175663
2025-04-27 11:06:23,615 - __main__ - INFO - Found 23 tables in the document
2025-04-27 11:06:23,615 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-27 11:06:23,615 - __main__ - INFO - Found 20 data rows
2025-04-27 11:06:23,617 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=161
2025-04-27 11:06:23,617 - __main__ - INFO - Extracted data for 20 stocks
2025-04-27 11:06:23,735 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-27 11:06:23,735 - __main__ - INFO - Added 20 stocks from page 8 (total: 160)
2025-04-27 11:06:23,736 - __main__ - INFO - Waiting 3.92 seconds before next page...
2025-04-27 11:06:27,662 - __main__ - INFO - Scraping page 9: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=161
2025-04-27 11:06:27,663 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=161
2025-04-27 11:06:30,472 - __main__ - INFO - Successfully fetched page, length: 175536
2025-04-27 11:06:30,526 - __main__ - INFO - Found 23 tables in the document
2025-04-27 11:06:30,526 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-27 11:06:30,526 - __main__ - INFO - Found 20 data rows
2025-04-27 11:06:30,528 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=181
2025-04-27 11:06:30,528 - __main__ - INFO - Extracted data for 20 stocks
2025-04-27 11:06:30,651 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-27 11:06:30,651 - __main__ - INFO - Added 20 stocks from page 9 (total: 180)
2025-04-27 11:06:30,651 - __main__ - INFO - Waiting 3.73 seconds before next page...
2025-04-27 11:06:34,386 - __main__ - INFO - Scraping page 10: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=181
2025-04-27 11:06:34,386 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=181
2025-04-27 11:06:36,590 - __main__ - INFO - Successfully fetched page, length: 175500
2025-04-27 11:06:36,646 - __main__ - INFO - Found 23 tables in the document
2025-04-27 11:06:36,646 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-04-27 11:06:36,646 - __main__ - INFO - Found 20 data rows
2025-04-27 11:06:36,648 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,sh_opt_option&r=201
2025-04-27 11:06:36,648 - __main__ - INFO - Extracted data for 20 stocks
2025-04-27 11:06:36,760 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-04-27 11:06:36,760 - __main__ - INFO - Added 20 stocks from page 10 (total: 200)
2025-04-27 11:06:36,760 - __main__ - INFO - Waiting 3.41 seconds before next page...
2025-04-27 11:06:40,174 - __main__ - INFO - Scraping completed. Total stocks: 200
2025-04-27 11:06:40,175 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 200
2025-05-01 05:10:53,062 - __main__ - INFO - Table stock_quotes created or already exists
2025-05-01 05:10:53,063 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_largeover%2Cfa_eps5years_o10%2Cfa_roe_o10%2Cfa_sales5years_o10%2Csh_opt_option&ft=2&o=-marketcap
2025-05-01 05:10:53,063 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover%2Cfa_eps5years_o10%2Cfa_roe_o10%2Cfa_sales5years_o10%2Csh_opt_option&ft=2&o=-marketcap
2025-05-01 05:10:55,724 - __main__ - INFO - Successfully fetched page, length: 190844
2025-05-01 05:10:55,806 - __main__ - INFO - Found 15 tables in the document
2025-05-01 05:10:55,807 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-05-01 05:10:55,807 - __main__ - INFO - Found 20 data rows
2025-05-01 05:10:55,809 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=21
2025-05-01 05:10:55,809 - __main__ - INFO - Extracted data for 20 stocks
2025-05-01 05:10:55,932 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-05-01 05:10:55,933 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-05-01 05:10:55,933 - __main__ - INFO - Waiting 3.05 seconds before next page...
2025-05-01 05:10:58,987 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=21
2025-05-01 05:10:58,987 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=21
2025-05-01 05:11:00,711 - __main__ - INFO - Successfully fetched page, length: 191452
2025-05-01 05:11:00,767 - __main__ - INFO - Found 15 tables in the document
2025-05-01 05:11:00,767 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-05-01 05:11:00,767 - __main__ - INFO - Found 20 data rows
2025-05-01 05:11:00,769 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=41
2025-05-01 05:11:00,769 - __main__ - INFO - Extracted data for 20 stocks
2025-05-01 05:11:00,861 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-05-01 05:11:00,861 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-05-01 05:11:00,861 - __main__ - INFO - Waiting 2.54 seconds before next page...
2025-05-01 05:11:03,405 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=41
2025-05-01 05:11:03,406 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=41
2025-05-01 05:11:06,260 - __main__ - INFO - Successfully fetched page, length: 191289
2025-05-01 05:11:06,327 - __main__ - INFO - Found 15 tables in the document
2025-05-01 05:11:06,327 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-05-01 05:11:06,328 - __main__ - INFO - Found 20 data rows
2025-05-01 05:11:06,329 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=61
2025-05-01 05:11:06,329 - __main__ - INFO - Extracted data for 20 stocks
2025-05-01 05:11:06,417 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-05-01 05:11:06,419 - __main__ - INFO - Added 20 stocks from page 3 (total: 60)
2025-05-01 05:11:06,419 - __main__ - INFO - Waiting 3.28 seconds before next page...
2025-05-01 05:11:09,697 - __main__ - INFO - Scraping page 4: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=61
2025-05-01 05:11:09,698 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=61
2025-05-01 05:11:12,467 - __main__ - INFO - Successfully fetched page, length: 191554
2025-05-01 05:11:12,516 - __main__ - INFO - Found 15 tables in the document
2025-05-01 05:11:12,516 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-05-01 05:11:12,517 - __main__ - INFO - Found 20 data rows
2025-05-01 05:11:12,519 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=81
2025-05-01 05:11:12,519 - __main__ - INFO - Extracted data for 20 stocks
2025-05-01 05:11:12,620 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-05-01 05:11:12,620 - __main__ - INFO - Added 20 stocks from page 4 (total: 80)
2025-05-01 05:11:12,620 - __main__ - INFO - Waiting 2.20 seconds before next page...
2025-05-01 05:11:14,825 - __main__ - INFO - Scraping page 5: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=81
2025-05-01 05:11:14,825 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=81
2025-05-01 05:11:16,828 - __main__ - INFO - Successfully fetched page, length: 191457
2025-05-01 05:11:16,903 - __main__ - INFO - Found 15 tables in the document
2025-05-01 05:11:16,903 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-05-01 05:11:16,904 - __main__ - INFO - Found 20 data rows
2025-05-01 05:11:16,905 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=101
2025-05-01 05:11:16,905 - __main__ - INFO - Extracted data for 20 stocks
2025-05-01 05:11:16,995 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-05-01 05:11:16,995 - __main__ - INFO - Added 20 stocks from page 5 (total: 100)
2025-05-01 05:11:16,995 - __main__ - INFO - Waiting 3.70 seconds before next page...
2025-05-01 05:11:20,703 - __main__ - INFO - Scraping page 6: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=101
2025-05-01 05:11:20,704 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=101
2025-05-01 05:11:23,048 - __main__ - INFO - Successfully fetched page, length: 191690
2025-05-01 05:11:23,106 - __main__ - INFO - Found 15 tables in the document
2025-05-01 05:11:23,106 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-05-01 05:11:23,106 - __main__ - INFO - Found 20 data rows
2025-05-01 05:11:23,108 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=121
2025-05-01 05:11:23,108 - __main__ - INFO - Extracted data for 20 stocks
2025-05-01 05:11:23,203 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-05-01 05:11:23,203 - __main__ - INFO - Added 20 stocks from page 6 (total: 120)
2025-05-01 05:11:23,203 - __main__ - INFO - Waiting 3.85 seconds before next page...
2025-05-01 05:11:27,056 - __main__ - INFO - Scraping page 7: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=121
2025-05-01 05:11:27,056 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=121
2025-05-01 05:11:29,297 - __main__ - INFO - Successfully fetched page, length: 181096
2025-05-01 05:11:29,345 - __main__ - INFO - Found 15 tables in the document
2025-05-01 05:11:29,345 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-05-01 05:11:29,345 - __main__ - INFO - Found 16 data rows
2025-05-01 05:11:29,347 - __main__ - INFO - No 'next' link found.
2025-05-01 05:11:29,347 - __main__ - INFO - Extracted data for 16 stocks
2025-05-01 05:11:29,450 - __main__ - INFO - Successfully upserted data for 16 stocks
2025-05-01 05:11:29,450 - __main__ - INFO - Added 16 stocks from page 7 (total: 136)
2025-05-01 05:11:29,450 - __main__ - INFO - Scraping completed. Total stocks: 136
2025-05-01 05:11:29,450 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 136
2025-05-01 13:41:27,358 - __main__ - INFO - Table stock_quotes created or already exists
2025-05-01 13:41:27,360 - __main__ - INFO - Scraping page 1: https://finviz.com/screener.ashx?v=111&f=cap_largeover%2Cfa_eps5years_o10%2Cfa_roe_o10%2Cfa_sales5years_o10%2Csh_opt_option&ft=2&o=-marketcap
2025-05-01 13:41:27,360 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover%2Cfa_eps5years_o10%2Cfa_roe_o10%2Cfa_sales5years_o10%2Csh_opt_option&ft=2&o=-marketcap
2025-05-01 13:41:30,060 - __main__ - INFO - Successfully fetched page, length: 190922
2025-05-01 13:41:30,136 - __main__ - INFO - Found 15 tables in the document
2025-05-01 13:41:30,136 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-05-01 13:41:30,136 - __main__ - INFO - Found 20 data rows
2025-05-01 13:41:30,138 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=21
2025-05-01 13:41:30,138 - __main__ - INFO - Extracted data for 20 stocks
2025-05-01 13:41:30,283 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-05-01 13:41:30,283 - __main__ - INFO - Added 20 stocks from page 1 (total: 20)
2025-05-01 13:41:30,283 - __main__ - INFO - Waiting 3.30 seconds before next page...
2025-05-01 13:41:33,593 - __main__ - INFO - Scraping page 2: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=21
2025-05-01 13:41:33,593 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=21
2025-05-01 13:41:36,860 - __main__ - INFO - Successfully fetched page, length: 191475
2025-05-01 13:41:36,909 - __main__ - INFO - Found 15 tables in the document
2025-05-01 13:41:36,909 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-05-01 13:41:36,909 - __main__ - INFO - Found 20 data rows
2025-05-01 13:41:36,911 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=41
2025-05-01 13:41:36,911 - __main__ - INFO - Extracted data for 20 stocks
2025-05-01 13:41:37,241 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-05-01 13:41:37,242 - __main__ - INFO - Added 20 stocks from page 2 (total: 40)
2025-05-01 13:41:37,242 - __main__ - INFO - Waiting 3.68 seconds before next page...
2025-05-01 13:41:40,928 - __main__ - INFO - Scraping page 3: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=41
2025-05-01 13:41:40,928 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=41
2025-05-01 13:41:43,795 - __main__ - INFO - Successfully fetched page, length: 191295
2025-05-01 13:41:43,850 - __main__ - INFO - Found 15 tables in the document
2025-05-01 13:41:43,850 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-05-01 13:41:43,850 - __main__ - INFO - Found 20 data rows
2025-05-01 13:41:43,852 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=61
2025-05-01 13:41:43,852 - __main__ - INFO - Extracted data for 20 stocks
2025-05-01 13:41:43,966 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-05-01 13:41:43,966 - __main__ - INFO - Added 20 stocks from page 3 (total: 60)
2025-05-01 13:41:43,966 - __main__ - INFO - Waiting 3.07 seconds before next page...
2025-05-01 13:41:47,042 - __main__ - INFO - Scraping page 4: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=61
2025-05-01 13:41:47,043 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=61
2025-05-01 13:41:48,522 - __main__ - INFO - Successfully fetched page, length: 191564
2025-05-01 13:41:48,573 - __main__ - INFO - Found 15 tables in the document
2025-05-01 13:41:48,573 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-05-01 13:41:48,573 - __main__ - INFO - Found 20 data rows
2025-05-01 13:41:48,575 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=81
2025-05-01 13:41:48,575 - __main__ - INFO - Extracted data for 20 stocks
2025-05-01 13:41:48,718 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-05-01 13:41:48,718 - __main__ - INFO - Added 20 stocks from page 4 (total: 80)
2025-05-01 13:41:48,718 - __main__ - INFO - Waiting 2.12 seconds before next page...
2025-05-01 13:41:50,848 - __main__ - INFO - Scraping page 5: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=81
2025-05-01 13:41:50,848 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=81
2025-05-01 13:41:52,697 - __main__ - INFO - Successfully fetched page, length: 191379
2025-05-01 13:41:52,770 - __main__ - INFO - Found 15 tables in the document
2025-05-01 13:41:52,770 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-05-01 13:41:52,770 - __main__ - INFO - Found 20 data rows
2025-05-01 13:41:52,772 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=101
2025-05-01 13:41:52,772 - __main__ - INFO - Extracted data for 20 stocks
2025-05-01 13:41:52,877 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-05-01 13:41:52,877 - __main__ - INFO - Added 20 stocks from page 5 (total: 100)
2025-05-01 13:41:52,877 - __main__ - INFO - Waiting 2.65 seconds before next page...
2025-05-01 13:41:55,536 - __main__ - INFO - Scraping page 6: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=101
2025-05-01 13:41:55,537 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=101
2025-05-01 13:41:57,917 - __main__ - INFO - Successfully fetched page, length: 191652
2025-05-01 13:41:57,969 - __main__ - INFO - Found 15 tables in the document
2025-05-01 13:41:57,969 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-05-01 13:41:57,970 - __main__ - INFO - Found 20 data rows
2025-05-01 13:41:57,972 - __main__ - INFO - Next Link HREF: screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=121
2025-05-01 13:41:57,972 - __main__ - INFO - Extracted data for 20 stocks
2025-05-01 13:41:58,080 - __main__ - INFO - Successfully upserted data for 20 stocks
2025-05-01 13:41:58,080 - __main__ - INFO - Added 20 stocks from page 6 (total: 120)
2025-05-01 13:41:58,080 - __main__ - INFO - Waiting 2.96 seconds before next page...
2025-05-01 13:42:01,049 - __main__ - INFO - Scraping page 7: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=121
2025-05-01 13:42:01,050 - __main__ - INFO - Fetching page: https://finviz.com/screener.ashx?v=111&f=cap_largeover,fa_eps5years_o10,fa_roe_o10,fa_sales5years_o10,sh_opt_option&ft=2&o=-marketcap&r=121
2025-05-01 13:42:02,637 - __main__ - INFO - Successfully fetched page, length: 183555
2025-05-01 13:42:02,693 - __main__ - INFO - Found 15 tables in the document
2025-05-01 13:42:02,693 - __main__ - INFO - Found headers: ['No.', 'Ticker', 'Company', 'Sector', 'Industry', 'Country', 'Market Cap', 'P/E', 'Price', 'Change', 'Volume']
2025-05-01 13:42:02,693 - __main__ - INFO - Found 17 data rows
2025-05-01 13:42:02,695 - __main__ - INFO - No 'next' link found.
2025-05-01 13:42:02,695 - __main__ - INFO - Extracted data for 17 stocks
2025-05-01 13:42:02,823 - __main__ - INFO - Successfully upserted data for 17 stocks
2025-05-01 13:42:02,824 - __main__ - INFO - Added 17 stocks from page 7 (total: 137)
2025-05-01 13:42:02,824 - __main__ - INFO - Scraping completed. Total stocks: 137
2025-05-01 13:42:02,824 - __main__ - INFO - Stock data collection completed successfully. Total stocks: 137
2025-05-01 14:07:41,340 - __main__ - INFO - Deleted all rows from tradeable_options table
2025-05-01 14:07:42,615 - __main__ - INFO - Successfully upserted 1641 rows into tradeable_options
>>>>>>> b073fbe1f1d25c12eefa3873996b826587d764f1
